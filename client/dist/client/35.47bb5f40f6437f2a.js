"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[35],{6035:(J,_,l)=>{l.r(_),l.d(_,{HomeModule:()=>H});var a=l(6895),g=l(6237),f=l(5861);function u(n){let i=0;requestAnimationFrame(function e(){n(i)&&requestAnimationFrame(e),i++})}var h=l(6745),t=l(8256),d=l(2969);let p=(()=>{class n{constructor(){this.storysData=[],this.methods={}}set(e,o){this.methods[e]=o}get(e){return this.methods[e]}setStorysData(e){this.storysData=e}getStorysData(){return this.storysData}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const C=["container"];function y(n,i){1&n&&t._UZ(0,"img",4)}function v(n,i){if(1&n&&t._UZ(0,"img",10),2&n){const e=t.oxw(2);t.Q6J("src",e.story.url,t.LSH)}}function M(n,i){1&n&&t._UZ(0,"video",15)}function O(n,i){if(1&n&&(t.TgZ(0,"div",5),t.YNc(1,v,1,1,"img",6),t.YNc(2,M,1,0,"video",7),t.TgZ(3,"div",8)(4,"div",9),t._UZ(5,"img",10),t.TgZ(6,"h6")(7,"span",11),t._uU(8,"chat"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"h6")(11,"span",12),t._uU(12,"favorite"),t.qZA(),t._uU(13),t.qZA(),t.TgZ(14,"h6")(15,"span",13),t._uU(16,"visibility"),t.qZA(),t._uU(17),t.qZA()(),t.TgZ(18,"div",14)(19,"h1"),t._uU(20),t.qZA(),t.TgZ(21,"h3"),t._uU(22),t.qZA()()()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","png"==e.story.type||"jpg"==e.story.type),t.xp6(1),t.Q6J("ngIf","mp4"==e.story.type),t.xp6(3),t.Q6J("src",e.story.profileImage,t.LSH),t.xp6(2),t.MGl("routerLink","comments/story",e.id,""),t.xp6(2),t.hij(" ",e.comments.length," "),t.xp6(2),t.Q6J("ngClass",e.searchLikes()?"like":"dislike"),t.xp6(2),t.hij(" ",e.story.likes.length," "),t.xp6(4),t.hij(" ",e.story.view.length," "),t.xp6(3),t.Oqu(e.story.userName),t.xp6(2),t.Oqu(e.story.description)}}let x=(()=>{class n{constructor(e,o){this.appService=e,this.homeService=o,this.device=this.appService.getDevice(),this.storysStyle={height:window.innerHeight-80+"px"},this.comments=[]}ngOnInit(){}ngAfterViewInit(){this.homeService.set(`story${this.id}`,this);let e=this.container.nativeElement;e.addEventListener("touchstart",o=>{let c=o.touches[0].pageY;e.addEventListener("touchend",r=>{let m=r.changedTouches[0].pageY-c;this.homeService.get("setScroll")(this.id,m)})}),0==this.id&&this.downloadStory()}searchLikes(){return!!this.story?.likes.find(o=>o==this.data.user)}downloadStory(){let e=this;this.story||(0,h.M)("POST",this.appService.getURL()+"/downloadStory",[{name:"storyId",value:this.data.id},{name:"user",value:this.data.user}],(o,c)=>{let r=JSON.parse(o);r.url=`${this.appService.getURL()}/${e.data.user}/DCIM/${r.url}`,r.profileImage=`${this.appService.getURL()}/${e.data.user}/DCIM/${r.profileImage}`;let s="png"==r.type||"jpg"==r.type?new Image:document.createElement("video");s.src=r.url,s.addEventListener("load",()=>{(0,h.M)("POST",this.appService.getURL()+"/downloadComments",[{name:"storyId",value:e.data.id},{name:"user",value:e.data.user}],(m,Y)=>{let I=JSON.parse(m);e.comments=I,e.story=r,this.appService.socket.on("commend"+e.story?.id,A=>{e.comments.push(A)})})})})}getScrollTop(){return document.getElementById("home_storys").scrollTop}getStory(){return this.story}getCommends(){return this.comments}getDevice(){return this.appService.getDevice()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.z),t.Y36(p))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-story"]],viewQuery:function(e,o){if(1&e&&t.Gf(C,5),2&e){let c;t.iGM(c=t.CRH())&&(o.container=c.first)}},inputs:{data:"data",id:"id"},decls:4,vars:6,consts:[[3,"id","ngClass"],["container",""],["class","loading","src","../../../../assets/loading.gif","alt","",4,"ngIf"],["class","story_container",4,"ngIf"],["src","../../../../assets/loading.gif","alt","",1,"loading"],[1,"story_container"],["alt","",3,"src",4,"ngIf"],["src","story.url",4,"ngIf"],[1,"details"],[1,"profile"],["alt","",3,"src"],[1,"material-symbols-rounded",3,"routerLink"],[1,"material-symbols-rounded",3,"ngClass"],[1,"material-symbols-rounded"],[1,"description"],["src","story.url"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0,1),t.YNc(2,y,1,0,"img",2),t.YNc(3,O,23,10,"div",3),t.qZA()),2&e&&(t.Akn(o.storysStyle),t.MGl("id","story",o.id,""),t.Q6J("ngClass",o.getDevice()),t.xp6(2),t.Q6J("ngIf",!o.story),t.xp6(1),t.Q6J("ngIf",o.story))},dependencies:[a.mk,a.O5,g.rH],styles:[".container_mobile[_ngcontent-%COMP%]{position:relative;width:100%;background-color:#f0f8ff;display:flex;flex-direction:column;align-items:center;justify-content:center;border-bottom:solid 2px black;box-sizing:border-box}.container_mobile[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{width:50px;height:50px}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:flex-end;justify-content:space-between}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;height:100%;width:100%;justify-content:space-between;position:absolute;top:0}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;height:80%}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border:solid 1px gold;border-radius:25px}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:gold;display:flex;flex-direction:column;align-items:center;font-size:3vw;margin-top:30px}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]   .like[_ngcontent-%COMP%]{font-size:7vw;color:gold}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]   .dislike[_ngcontent-%COMP%]{font-size:7vw;color:#fff}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{width:100%;height:18%;background-color:#00000043;padding:10px;box-sizing:border-box;color:#fff;overflow-y:auto}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:4vw}.container_mobile[_ngcontent-%COMP%]   .story_container[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:3vw}"]}),n})();function P(n,i){if(1&n&&t._UZ(0,"app-story",5),2&n){const e=i.$implicit,o=t.oxw();t.Q6J("data",e)("id",o.getStorysData().indexOf(e))}}let b=(()=>{class n{constructor(e,o,c){this.appService=e,this.homeService=o,this.actRouter=c,this.device=this.appService.getDevice(),this.storysStyle={height:window.innerHeight-80+"px"},this.homeService.set("setScroll",this.setScroll.bind(this))}setScroll(e,o){let c=document.getElementById("home_storys");if(Math.abs(o)>100){if(o<0&&document.getElementById("story"+(e+1))){let s=c.scrollHeight/this.homeService.getStorysData().length*(e+1);u(m=>(c.scrollTop+=40,!(c.scrollTop>=s&&(c.scrollTop=s,this.homeService.get(`story${e+1}`).downloadStory(),1))))}if(o>0&&document.getElementById("story"+(e-1))){let s=c.scrollHeight/this.homeService.getStorysData().length*(e-1);u(m=>(c.scrollTop-=40,!(c.scrollTop<=s&&(c.scrollTop=s,this.homeService.get("story"+(e-1)).downloadStory(),1))))}}else{let s=c.scrollHeight/this.homeService.getStorysData().length*e;c.scrollTop=s}}ngOnInit(){var e=this;return(0,f.Z)(function*(){yield(0,h.M)("POST",e.appService.getURL()+"/downloadStorys",[],(o,c)=>{e.homeService.setStorysData(JSON.parse(o))})})()}getStorysData(){return this.homeService.getStorysData()}getDevice(){return this.appService.getDevice()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.z),t.Y36(p),t.Y36(g.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-home"]],decls:8,vars:4,consts:[[3,"ngClass"],[1,"head"],["src","assets/images/icon.png","alt",""],["id","home_storys",1,"storys"],[3,"data","id",4,"ngFor","ngForOf"],[3,"data","id"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"img",2),t.TgZ(3,"h1"),t._uU(4,"INICIO"),t.qZA()(),t.TgZ(5,"div",3),t.YNc(6,P,1,2,"app-story",4),t.qZA()(),t._UZ(7,"router-outlet")),2&e&&(t.Q6J("ngClass",o.getDevice()),t.xp6(5),t.Akn(o.storysStyle),t.xp6(1),t.Q6J("ngForOf",o.getStorysData()))},dependencies:[a.mk,a.sg,g.lC,x],styles:[".container_mobile[_ngcontent-%COMP%]{width:100vw;height:100px;background-color:#000}.container_mobile[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]{width:100%;height:80px;background-color:#303030;display:flex;align-items:center}.container_mobile[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;margin-left:20px}.container_mobile[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:700;font-size:20px;line-height:120%;display:flex;align-items:center;text-align:center;color:#ffdda6;margin-left:20px}.container_mobile[_ngcontent-%COMP%]   .storys[_ngcontent-%COMP%]{background-color:#ffdda6;overflow-y:auto}"]}),n})();const S=function(){return{"align-items":"flex-end"}},w=function(){return{"align-items":"flex-start"}};let D=(()=>{class n{constructor(e,o){this.homeService=e,this.appService=o}getDevice(){return this.appService.getDevice()}getUser(){return this.appService.getUser().user}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p),t.Y36(d.z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-msg"]],inputs:{commendData:"commendData"},decls:9,vars:8,consts:[[3,"ngStyle","ngClass"],[3,"ngClass"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1"),t._uU(3),t.qZA(),t.TgZ(4,"div")(5,"h2"),t._uU(6),t.qZA(),t.TgZ(7,"h3"),t._uU(8),t.qZA()()()()),2&e&&(t.Q6J("ngStyle",o.getUser()==o.commendData.user?t.DdM(6,S):t.DdM(7,w))("ngClass",o.getDevice()),t.xp6(1),t.Q6J("ngClass",o.getUser()==o.commendData.user?"msg_c1":"msg_c2"),t.xp6(2),t.Oqu(o.commendData.userName),t.xp6(3),t.Oqu(o.commendData.commend),t.xp6(2),t.Oqu(o.commendData.time))},dependencies:[a.mk,a.PC],styles:[".container_mobile[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.container_mobile[_ngcontent-%COMP%]   .msg_c1[_ngcontent-%COMP%]{background-color:#daa520;float:right;display:flex;flex-direction:column;max-width:70%;padding:10px;border-radius:30px 30px 0;margin:15px}.container_mobile[_ngcontent-%COMP%]   .msg_c1[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{box-sizing:border-box;font-size:4vw;color:gray;margin-bottom:5px;width:100%;text-align:left;padding:0 5px 1px;border-bottom:1px solid gray}.container_mobile[_ngcontent-%COMP%]   .msg_c1[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:flex-end;color:#555;justify-content:end;flex-wrap:wrap}.container_mobile[_ngcontent-%COMP%]   .msg_c1[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:3vw;margin-right:5px}.container_mobile[_ngcontent-%COMP%]   .msg_c1[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:2vw;margin:2px}.container_mobile[_ngcontent-%COMP%]   .msg_c2[_ngcontent-%COMP%]{background-color:#8b8b8b;float:right;display:flex;flex-direction:column;max-width:70%;padding:10px;border-radius:30px 30px 30px 0;margin:15px}.container_mobile[_ngcontent-%COMP%]   .msg_c2[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{box-sizing:border-box;font-size:4vw;color:#4d4d4d;margin-bottom:5px;width:100%;text-align:left;padding:0 5px 1px;border-bottom:1px solid rgb(95,95,95)}.container_mobile[_ngcontent-%COMP%]   .msg_c2[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:flex-end;color:#383838;justify-content:end;flex-wrap:wrap}.container_mobile[_ngcontent-%COMP%]   .msg_c2[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:3vw;margin-right:5px}.container_mobile[_ngcontent-%COMP%]   .msg_c2[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:2vw;margin:2px}"]}),n})();const T=["chatBox"],Z=["commendsContainer"];function k(n,i){1&n&&t._UZ(0,"app-msg",10),2&n&&t.Q6J("commendData",i.$implicit)}const U=[{path:"",component:b,children:[{path:"comments/:id",component:(()=>{class n{constructor(e,o,c){this.actRouter=e,this.appService=o,this.homeService=c,this.actRouter.params.subscribe(r=>{let s=r.id;this.commendsData={story:this.homeService.get(s).getStory(),commends:this.homeService.get(s).getCommends()}})}ngOnInit(){}ngAfterViewInit(){this.appService.socket.on("commend"+this.commendsData.story.id,e=>{setTimeout(()=>{this.setScroll()},100)}),this.setScroll()}sendCommend(){if(""!==this.chatBox.nativeElement.value){let e=new Date,o=e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear(),c=e.getHours()+":"+e.getMinutes(),r={commend:this.chatBox.nativeElement.value,user:this.appService.getUser().user,userName:this.appService.getUser().userName,date:o,time:c};this.appService.socket.emit("commend",this.commendsData.story,r),this.chatBox.nativeElement.value=""}}getDevice(){return this.appService.getDevice()}setScroll(){let e=this.commendsContainer.nativeElement,o=e.getBoundingClientRect();e.scrollHeight>o.height&&(e.scrollTop=e.scrollHeight-o.height)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g.gz),t.Y36(d.z),t.Y36(p))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-comments"]],viewQuery:function(e,o){if(1&e&&(t.Gf(T,5),t.Gf(Z,5)),2&e){let c;t.iGM(c=t.CRH())&&(o.chatBox=c.first),t.iGM(c=t.CRH())&&(o.commendsContainer=c.first)}},decls:13,vars:2,consts:[[3,"ngClass"],[1,"head"],["routerLink","/petgram/home",1,"material-symbols-rounded"],[1,"comments"],["commendsContainer",""],[3,"commendData",4,"ngFor","ngForOf"],[1,"chatbox"],["type","text","placeholder","Escribe un comentario:"],["chatBox",""],[1,"material-symbols-rounded",3,"click"],[3,"commendData"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"span",2),t._uU(3,"arrow_circle_left"),t.qZA()(),t.TgZ(4,"div",3,4),t.YNc(6,k,1,1,"app-msg",5),t.qZA(),t.TgZ(7,"div",6)(8,"div"),t._UZ(9,"input",7,8),t.TgZ(11,"span",9),t.NdJ("click",function(){return o.sendCommend()}),t._uU(12,"send"),t.qZA()()()()),2&e&&(t.Q6J("ngClass",o.getDevice()),t.xp6(6),t.Q6J("ngForOf",o.commendsData.commends))},dependencies:[a.mk,a.sg,g.rH,D],styles:[".container_mobile[_ngcontent-%COMP%]{width:100vw;height:100vh;background-color:#f0f8ff77;position:absolute;z-index:10;left:0;top:0;background-image:url(comments_back.f9a7126911fcaff3.png);background-size:cover;background-position:center;display:flex;flex-direction:column;justify-content:space-between}.container_mobile[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]{width:100%;display:flex}.container_mobile[_ngcontent-%COMP%]   .head[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:gray;font-size:8vw;margin:8px}.container_mobile[_ngcontent-%COMP%]   .comments[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto}.container_mobile[_ngcontent-%COMP%]   .chatbox[_ngcontent-%COMP%]{width:100%;height:50px;display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.container_mobile[_ngcontent-%COMP%]   .chatbox[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:80%;height:100%;border-radius:50px;background-color:#575757;display:flex;justify-content:space-between;align-items:center;padding:5px;box-sizing:border-box}.container_mobile[_ngcontent-%COMP%]   .chatbox[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:100%;width:80%;border-radius:50px;border:0;background-color:transparent;outline:none;font-size:12px;color:#fff;padding-left:10px}.container_mobile[_ngcontent-%COMP%]   .chatbox[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:25px;margin-right:10px;color:#ccc}"]}),n})()}]}];let z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.Bz.forChild(U),g.Bz]}),n})(),H=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[a.ez,z]}),n})()}}]);